
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta content="width=device-width, initial-scale=1, maximum-scale=1, shrink-to-fit=no" name="viewport">
  <title>DSC PENS Event &mdash; Platform  </title>

  <!-- General CSS Files -->
  <link rel="stylesheet" href="asset_dua/modules/bootstrap/css/bootstrap.min.css">
  <link rel="stylesheet" href="asset_dua/modules/fontawesome/css/all.min.css">
  <!-- CSS Libraries -->

  <!-- Template CSS -->
  <link rel="stylesheet" href="asset_dua/css/style.css">
  <link rel="stylesheet" href="asset_dua/css/components.css">

  <!-- custom -->
  <link rel="stylesheet" href="asset_dua/custom/custom.css">
  <style>
    body, input {
      font-size:14pt
    }
    input, label {
      vertical-align:middle
    }
    .qrcode-text {
      padding-right:1.7em; 
      margin-right:0
    }
    .qrcode-text-btn {
        display: inline-block;
        background: url(asset_dua/custom/img/scan-qr.png) 50% 50% no-repeat;
        margin-top: 10px;
        /* height: 1em; */
         width: 100%; 
        /* margin-left: -1.7em; */
        cursor: pointer;
    }
    .qrcode-text-btn > input[type=file] {
        /* float: left; */
        /* text-align: center; */
        padding-bottom: 10px;
        /* position: absolute; */
        /* overflow: hidden; */
        /* width: 100%; */
        opacity: 0;
    }
  </style>

  <!-- favicon -->
  <link rel="icon" href="asset_dua/custom/img/dsc.png" sizes="50x50" type="image/png">

  <!-- Start GA -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-94034622-3"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-94034622-3');
  </script>
  <!-- /END GA -->

  <link rel="manifest" href="manifest.json">

</head>

<body onload="getLocation()">
  <div id="app">
    <div class="main-wrapper main-wrapper-1">
      <div class="navbar-bg"></div>
      <nav class="navbar navbar-expand-lg main-navbar">
        <form class="form-inline mr-auto">
          <ul class="navbar-nav mr-3">
            <li><a href="#" class="nav-link nav-link-lg"><img src="asset_dua/custom/img/dsc.png" width="22px"></a></li>
            <!-- <img src="asset_dua/custom/img/dsc.png" width="8%" height="8%" class="mr-2 mt-2"> -->
            <span style="margin-top: 4px; font-size: 12px; color: white; font-weight: bold;">DCS PENS - EVENT PLATFORM</span> 
          </ul>
        </form>
        <ul class="navbar-nav navbar-right">
          <li class="dropdown">
            <a href="#" data-toggle="dropdown" class="nav-link  nav-link-lg nav-link-user"><i class="fas fa-ellipsis-v"></i></a>
            <div class="dropdown-menu dropdown-menu-right">
              <!-- <div class="dropdown-title" id="email_text"></div> -->
              <a href="" class="dropdown-item has-icon" data-toggle="modal" data-target="#modal-collect">
                <i class="fas fa-gem"></i> Collect Points
              </a>
              <div class="dropdown-divider"></div>
              <a href="#" class="dropdown-item has-icon text-danger" id="logout">
                <i class="fas fa-sign-out-alt"></i> Logout
              </a>
            </div>
          </li>
        </ul>
      </nav>
     <!--   <div class="main-sidebar sidebar-style-2">
        <aside id="sidebar-wrapper">
          <div class="sidebar-brand">
            <a href="index.html">Event Platform</a>
          </div>
          <div class="sidebar-brand sidebar-brand-sm">
            <a href="index.html">St</a>
          </div>
          <ul class="sidebar-menu">
            <li class="menu-header">Dashboard</li>
            <li class="dropdown">
              <a href="#" class="nav-link has-dropdown"><i class="fas fa-fire"></i><span>Dashboard</span></a>
              <ul class="dropdown-menu">
                <li><a class="nav-link" href="index-0.html">General Dashboard</a></li>
                <li><a class="nav-link" href="index.html">Ecommerce Dashboard</a></li>
              </ul>
            </li>
          </ul>
        </aside>
      </div> -->
      <!-- Main Content -->
      <div class="main-content">
        <section class="section">
          
          <div class="row">
            <div class="col-lg-12 col-md-12 col-sm-12">
              <div class="card card-statistic-2">
                <div class="card-wrap">
                  <div class="card-body text-center">
                    <h4 id="MyClockDisplay" class="text-uppercase"></h4>
                    <p class="lokasi" id="demo" name="lokasi" ></p>
                  </div>
                </div>
              </div>
            </div>
          </div>


          <div class="summary-item mb-5">
            <ul class="list-unstyled list-unstyled-border">
              <li class="media">
                <div class="media-body">
                  <div class="media-right">
                    <p class="badge badge-pill badge-warning float-right" id="point_text"></p>
                    <!-- <div class="badge badge-pill badge-warning float-right ml-4" id="point_text">100</div> -->
                  </div>
                  <div class="media-title" id="email_text"></div>
                  <div class="text-muted text-small">your point</div>
                </div>
              </li>
            </ul>
          </div>



         <div class="summary-item mb-5">
            <h6>Redeem point</h6>
            <ul class="list-unstyled list-unstyled-border">
              <li class="media">
                <div class="media-body">
                  <div class="media-right">
                    <a href="" class="btn btn-primary" data-toggle="modal" data-target="#sticker">Redeem</a>
                  </div>
                  <div class="media-title">DSC PENS Sticker</div>
                  <div class="text-muted text-small">Point redeem <div class="bullet"></div> 10 Points</div>
                </div>
              </li>
              <li class="media">
                <div class="media-body">
                  <div class="media-right">
                    <a href="" class="btn btn-primary" data-toggle="modal" data-target="#pin">Redeem</a>
                  </div>
                  <div class="media-title">DSC PENS Pin</div>
                  <div class="text-muted text-small">Point redeem <div class="bullet"></div> 15 Points</div>
                </div>
              </li>
              <li class="media">
                <div class="media-body">
                  <div class="media-right">
                    <a href="" class="btn btn-primary" data-toggle="modal" data-target="#modal-gantungan">Redeem</a>
                  </div>
                  <div class="media-title">DSC PENS Gantungan Kunci</div>
                  <div class="text-muted text-small">Point redeem <div class="bullet"></div> 15 Points</div>
                </div>
              </li>
              <li class="media">
                <div class="media-body">
                 <div class="media-right">
                    <a href="" class="btn btn-primary" data-toggle="modal" data-target="#tshirt">Redeem</a>
                  </div>
                  <div class="media-title">DSC PENS T-Shirt</div>
                  <div class="text-muted text-small">Point redeem <div class="bullet"></div> 150 Points</div>
                </div>
              </li>
            </ul>
          </div>

        </section>
      </div>

     <!--  <footer class="main-footer">
        <div class="footer-left">
          Copyright &copy; 2019 <div class="bullet"></div> <span class="text-primary"> DSC PENS Event Platform</span> 
        </div>
        <div class="footer-right">
          
        </div>
      </footer> -->

       <!-- <div class="card" style="margin-bottom: 0px; position: fixed; bottom: 0; background-color: #6777ef; color: white; width: 100%;">
          <div class="card-header" id="collect_point" class="new_absen">
              <h6 id="email_text"></h6>
              <div class="badge badge-pill badge-warning float-right ml-4" id="point_text"></div>
          </div>
        </div> -->

    </div>
  </div>


  <!-- Modal boostrap -->
  <!-- COLLECT POINTS -->
  <div class="modal fade" tabindex="-1" role="dialog" id="modal-collect">
    <form id="collect_point" class="new_absen">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Collect Points</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <div class="form-group">
              <label for="Status">Event Type</label>
              <select class="form-control" id="status_collect">
                <option value="workshop">Workshop</option>
                <option value="hackathon">Hackathon</option>
                <option value="showcase">Showcase</option>
              </select>
            </div>

            
                <!-- <input type=text size=16 placeholder="Tracking Code" class=qrcode-text>
                <label class=qrcode-text-btn>
                  <input type=file accept="image/*" capture=environment onclick="return showQRIntro();" onchange="openQRCamera(this);" tabindex=-1>
                </label> 
                <input type=button value="Go" disabled> -->


            
              <!-- <label class="dz-default dz-message">
                <span>scan qr code</span>
                <input type=file accept="image/*" capture=environment onclick="return showQRIntro();" onchange="openQRCamera(this);" tabindex=-1>
              </label> -->
              
            <div class="form-group" >
              <label for="keterangan">Input token (DSC PENS Team) manually :</label>
              <input type="text" size="12" class="qrcode-text form-control" name="keterangan" id="keterangan_collect">
              <label class="qrcode-text-btn dropzone dz-clickable" id="mydropzone">
                <!-- <span>or scan qr code</span> --> 
                <input type=file accept="image/*" capture="environment" onclick="return showQRIntro();" onchange="openQRCamera(this);" tabindex="-1" placeholder="or scan qr code">
              </label>

            </div>
            <!-- <div class="form-group">
              <label for="keterangan">atau input token (DSC PENS Team) pada kolom berikut :</label>
              <input type="password" class="form-control" name="keterangan" id="keterangan_collect"></input>
            </div> -->
            <div class="form-group">
              <input type="hidden" id="loc" class="loc" name="custId" value="">
            </div>
          </div>
          <div class="modal-footer bg-whitesmoke br">
            <button type="submit" class="btn btn-primary">Collect</button>
            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
          </div>
        </div>
    </div>
    </form>
  </div>





  <!-- STICKER -->
  <div class="modal fade" tabindex="-1" role="dialog" id="sticker">
    <form id="redeem_point" class="new_stiker">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Redeem Point Sticker</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">

            <div class="form-group">
              <label for="jumlah_sticker">Jumlah sticker (Panitia)</label>
              <input type="number" class="form-control" name="jumlah_sticker" id="jumlah_sticker" rows="5"></input>
            </div>


            <div class="form-group" >
              <label for="keterangan">Input token (Panitia) manually :</label>
              <input type="password" size="12" class="qrcode-text form-control" name="keterangan" id="keterangan_sticker">
              <label class="qrcode-text-btn dropzone dz-clickable" id="mydropzone">
                <!-- <span>or scan qr code</span> --> 
                <input type=file accept="image/*" capture="environment" onclick="return showQRIntro();" onchange="openQRCamera(this);" tabindex="-1" placeholder="or scan qr code">
              </label>

            </div>


            <!-- <div class="form-group">
              <label for="keterangan">Input token (Panitia)</label>
              <input type="password" class="form-control" name="keterangan" id="keterangan_sticker" rows="5"></input>
            </div> -->

            <div class="form-group">
              <input type="hidden" id="redeemSticker" value="stiker">
            </div>
          </div>
          <div class="modal-footer bg-whitesmoke br">
            <button type="submit" class="btn btn-primary">Redeem</button>
            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
          </div>
        </div>
    </div>
    </form>
  </div>


   <!-- GANTUNGAN -->
  <div class="modal fade" tabindex="-1" role="dialog" id="modal-gantungan">
    <form id="redeem_point" class="new_gans">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Redeem Point Gantungan Kunci</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">

            <div class="form-group">
              <label for="jumlah_gans">Jumlah gantungan (Panitia)</label>
              <input type="number" class="form-control" name="jumlah_gans" id="jumlah_gans" rows="5"></input>
            </div>

            <!-- <div class="form-group">
              <label for="keterangan">Input token (Panitia)</label>
              <input type="password" class="form-control" name="keterangan" id="keterangan_gans" rows="5"></input>
            </div> -->

            <div class="form-group" >
              <label for="keterangan">Input token (Panitia) manually :</label>
              <input type="password" size="12" class="qrcode-text form-control" name="keterangan" id="keterangan_gans">
              <label class="qrcode-text-btn dropzone dz-clickable" id="mydropzone">
                <!-- <span>or scan qr code</span> --> 
                <input type=file accept="image/*" capture="environment" onclick="return showQRIntro();" onchange="openQRCamera(this);" tabindex="-1" placeholder="or scan qr code">
              </label>
            </div>

            <div class="form-group">
              <input type="hidden" id="redeemGans" value="gans">
            </div>

          </div>
          <div class="modal-footer bg-whitesmoke br">
            <button type="submit" class="btn btn-primary">Redeem</button>
            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
          </div>
        </div>
    </div>
    </form>
  </div>


  <!-- PIN -->
  <div class="modal fade" tabindex="-1" role="dialog" id="pin">
    <form id="redeem_point" class="new_pin">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Redeem Point Pin</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">

            <div class="form-group">
              <label for="jumlah_pin">Jumlah pin (Panitia)</label>
              <input type="number" class="form-control" name="jumlah_pin" id="jumlah_pin" rows="5"></input>
            </div>

            <!-- <div class="form-group">
              <label for="keterangan">Input token (Panitia)</label>
              <input type="password" class="form-control" name="keterangan" id="keterangan_pin" rows="5"></input>
            </div> -->

            <div class="form-group" >
              <label for="keterangan">Input token (Panitia) manually :</label>
              <input type="password" size="12" class="qrcode-text form-control" name="keterangan" id="keterangan_pin">
              <label class="qrcode-text-btn dropzone dz-clickable" id="mydropzone">
                <!-- <span>or scan qr code</span> --> 
                <input type=file accept="image/*" capture="environment" onclick="return showQRIntro();" onchange="openQRCamera(this);" tabindex="-1" placeholder="or scan qr code">
              </label>
            </div>

            <div class="form-group">
              <input type="hidden" id="redeemPin" value="pin">
            </div>
          </div>
          <div class="modal-footer bg-whitesmoke br">
            <button type="submit" class="btn btn-primary">Redeem</button>
            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
          </div>
        </div>
    </div>
    </form>
  </div>


  <!-- SHIRT -->
  <div class="modal fade" tabindex="-1" role="dialog" id="tshirt">
    <form id="redeem_point" class="new_kaos">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Redeem Point T-Shirt</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">

            <div class="form-group">
              <label for="jumlah_tshirt">Jumlah tshirt (Panitia)</label>
              <input type="number" class="form-control" name="jumlah_tshirt" id="jumlah_tshirt" rows="5"></input>
            </div>

            <!-- <div class="form-group">
              <label for="keterangan">Input token (Panitia)</label>
              <input type="password" class="form-control" name="keterangan" id="keterangan_kaos" rows="5"></input>
            </div> -->

            <div class="form-group" >
              <label for="keterangan">Input token (Panitia) manually :</label>
              <input type="password" size="12" class="qrcode-text form-control" name="keterangan" id="keterangan_kaos">
              <label class="qrcode-text-btn dropzone dz-clickable" id="mydropzone">
                <!-- <span>or scan qr code</span> --> 
                <input type=file accept="image/*" capture="environment" onclick="return showQRIntro();" onchange="openQRCamera(this);" tabindex="-1" placeholder="or scan qr code">
              </label>
            </div>

            <div class="form-group">
              <input type="hidden" id="redeemKaos" value="kaos">
            </div>
          </div>
          <div class="modal-footer bg-whitesmoke br">
            <button type="submit" class="btn btn-primary">Redeem</button>
            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
          </div>
        </div>
    </div>
    </form>
  </div>
  <!-- END: modal -->


  <!-- General JS Scripts -->
  <script src="asset_dua/modules/jquery.min.js"></script>
  <script src="asset_dua/modules/popper.js"></script>
  <script src="asset_dua/modules/tooltip.js"></script>
  <script src="asset_dua/modules/bootstrap/js/bootstrap.min.js"></script>
  <script src="asset_dua/modules/nicescroll/jquery.nicescroll.min.js"></script>
  <script src="asset_dua/modules/moment.min.js"></script>
  <script src="asset_dua/js/stisla.js"></script>
  <!-- JS Libraies -->

  <!-- Page Specific JS File -->

  <!-- Template JS File -->
  <script src="asset_dua/js/scripts.js"></script>
  <script src="asset_dua/js/custom.js"></script>
  <script src="asset_dua/custom/qr_reader.js"></script>
  <script>
    function openQRCamera(node) {
      var reader = new FileReader();
      reader.onload = function() {
        node.value = "";
        qrcode.callback = function(res) {
          if(res instanceof Error) {
            alert("No QR code found. Please make sure the QR code is within the camera's frame and try again.");
          } else {
            node.parentNode.previousElementSibling.value = res;
          }
        };
        qrcode.decode(reader.result);
      };
      reader.readAsDataURL(node.files[0]);
    }

    function showQRIntro() {
      return confirm("Use your camera to take a picture of a QR code.");
    }
  </script>
  <!-- END: Scan -->



  <script src="https://www.gstatic.com/firebasejs/5.5.1/firebase.js"></script>
  <script>
      if('serviceWorker' in navigator) {
        navigator.serviceWorker.register('sw.js')
          .then(function() {
                console.log('Service Worker Registered');
          });
      }
      var x = document.getElementById("demo");
      var loc = document.getElementsByClassName("loc")[0];
      var loc1 = document.getElementById("loc1");

      function getLocation() {
          if (navigator.geolocation) {
              navigator.geolocation.getCurrentPosition(showPosition);
          } else { 
              x.innerHTML = "Geolocation is not supported by this browser.";
          }
      }

      function showPosition(position) {
          

          var locAPI = "https://nominatim.openstreetmap.org/reverse?format=jsonv2&lat="+position.coords.latitude+"&lon="+ position.coords.longitude;
          //x.innerHTML = locAPI;
          $.getJSON(locAPI, function(data) {
              console.log(data);

              x.innerHTML = data.display_name;
              loc.value = data.display_name;
          });
      }
    </script>
    <script src="https://www.gstatic.com/firebasejs/5.7.0/firebase.js"></script>
    <script>
      // Initialize Firebase
      var config = {
        apiKey: "AIzaSyBA9GF6vq0z5_qUWrVOUzaGy1P--ZqDQXM",
        authDomain: "dscpens-event.firebaseapp.com",
        databaseURL: "https://dscpens-event.firebaseio.com",
        projectId: "dscpens-event",
        storageBucket: "dscpens-event.appspot.com",
        messagingSenderId: "980829139366"
      };
      firebase.initializeApp(config);
    </script>
    <script src="user.js"></script>
    <script type="text/javascript">
        var tokenInput_collect;
        var tokenInput_redeem;
        var tokenInput_gans;
        var tokenInput_pin;
        var tokenInput_sticker;
        var tokenInput_kaos;
        var status_collect;
        var status_redeem;
        var email_text;
        var point_text;
        var user_email;
        var uid;
        var rGans
        var rPin;
        var rSticker;
        var rKaos;
        var jGans;
        var jSticker;
        var jPin;
        var jKaos;
         document.addEventListener("DOMContentLoaded", function(){
             tokenInput_collect = document.getElementById("keterangan_collect");
             tokenInput_redeem = document.getElementById("keterangan_redeem");

             tokenInput_gans = document.getElementById("keterangan_gans");
             tokenInput_pin = document.getElementById("keterangan_pin");
             tokenInput_sticker = document.getElementById("keterangan_sticker");
             tokenInput_kaos = document.getElementById("keterangan_kaos");

             status_collect = document.getElementById("status_collect");
             status_redeem = document.getElementById("status_redeem");
             email_text = document.getElementById("email_text");
             point_text = document.getElementById("point_text");

             rGans = document.getElementById("redeemGans"); 
             rPin = document.getElementById("redeemPin");
             rSticker = document.getElementById("redeemSticker");
             rKaos = document.getElementById("redeemKaos");

             jGans = document.getElementById("jumlah_gans");
             jPin = document.getElementById("jumlah_pin");
             jSticker = document.getElementById("jumlah_sticker");
             jKaos = document.getElementById("jumlah_tshirt");
             token = [];
//             });
        });
        
   firebase.database().ref('/list_token/showcase/').once('value').then(function(snapshot) {                      
                        snapshot.forEach(function(child){
                            token.push(child.val())
                        });
                        coll = token[0].token;
                        redm = token[1].token;
                        /* console.log(coll);
                        console.log(redm); */
                    });
                           

//        for(var i=0;i<10;i++){
//              generateTokenWorkshop();
//            generateTokenShowcase();
//          }
      firebase.auth().onAuthStateChanged(function (user) {
            if (user) {
            var point_data;
            user_email = firebase.auth().currentUser.email;
             email_text.innerHTML = user_email;
                    uid = firebase.auth().currentUser.uid;
            firebase.database().ref('users/'+uid).once('value')
                        .then(function(snapshot){
                point_data = snapshot.val().point;
                point_text.innerHTML = "Points: " + point_data;
             });
                var point_db;
                var action = "";
                var trans_status = false;
                $('.new_absen').submit(function(e){
                    action = "collect";
                    submitData();
                    e.preventDefault();    
                });
                
                $('.new_pin').submit(function(e){
                    action = "pin";
                    submitData();
                    e.preventDefault();    
                });

                $('.new_gans').submit(function(e){
                    action = "gans";
                    submitData();
                    e.preventDefault();    
                });
                
                $('.new_stiker').submit(function(e){
                    action = "stiker";
                    submitData();
                    e.preventDefault();    
                });

                $('.new_kaos').submit(function(e){
                    action = "kaos";
                    submitData();
                    e.preventDefault();    
                });
                
                function submitData(){
                    var date = new Date();
                    var hours = date.getHours(); // 0 - 23
                    var minutes = date.getMinutes(); // 0 - 59
                    var second = date.getSeconds(); // 0 - 59
                    var dt = date.getDate(); //tanggal
                    var months = ["January","February","March","April","May","June","July","August","September","October","November","December"];
                    var year = date.getFullYear() // tahun
                    var session = "AM";

                    if(hours == 0){
                        hours = 12;
                    }
                    
                    if(hours > 12){
                        hours = hours - 12;
                        session = "PM";
                    }
                    
                    hours = (hours < 10) ? "0" + hours : hours;
                    minutes = (minutes < 10) ? "0" + minutes : minutes;
                    second = (second < 10) ? "0" + second : second;
                    
                    var time = hours + ":" + minutes + ":" + second + " " + session;
                    var tanggal = dt + " " + months[date.getMonth()] + " " + year;

                    
                    var entry = {};
                    entry.status = $(this).find('[id="status"]').val();
                    entry.keterangan = $(this).find('[name="keterangan"]').val();
                    entry.lokasi = $(this).find('[class="loc"]').val();
                    entry.time = time;
                    entry.tanggal = tanggal;
                    entry.user = user.email;  var status; var wrong = true;
                    
                    firebase.database().ref('/list_token/showcase/').once('value').then(function(snapshot) {
                      
                        snapshot.forEach(function(child){
                            if(child.val().token == tokenInput_collect.value){
                                wrong = false;
                                status = true;
                            }
                        });
                        console.log("END");
                     if(wrong == true){
                         console.log("didnt same");
                     }
                     else{
                         console.log("same");
                     }
                        return false;
                    });        
                    var Absen = firebase.database().ref('users').child(uid);
                    
                    firebase.database().ref('users/'+uid).once('value')
                        .then(function(snapshot){
                     //   alert(status_collect.value.toLowerCase());
                    
                    if(action == "collect"){
                      if(status_collect.value.toLowerCase() == "workshop" && tokenInput_collect.value.toLowerCase() == coll) {
                        point_db = snapshot.val().point+25;
                        point_text.innerHTML = "Points: " + point_db;
                        alert("Poin Collection succeed.\nPoint : "+point_db);
                      }
                    
                      if(status_collect.value.toLowerCase() == "workshop" && tokenInput_collect.value.toLowerCase() != coll) {
                        alert("invalid token");
                      }

                      if(status_collect.value.toLowerCase() == "hackathon" && tokenInput_collect.value.toLowerCase() == coll) {
                        point_db = snapshot.val().point+30;
                        point_text.innerHTML = "Points: " + point_db;
                        alert("Poin Collection succeed.\nPoint : "+point_db);
                      }         
      
                      if(status_collect.value.toLowerCase() == "hackathon" && tokenInput_collect.value.toLowerCase() != coll) {
                        alert("invalid token");
                      }
                    
                      if(status_collect.value.toLowerCase() == "showcase" && tokenInput_collect.value.toLowerCase() == coll) {
                        point_db = snapshot.val().point+20;
                        point_text.innerHTML = "Points: " + point_db;
                        alert("Poin Collection succeed.\nPoint : "+point_db);
                      }         
      
                      if(status_collect.value.toLowerCase() == "showcase" && tokenInput_collect.value.toLowerCase() != coll) {
                        alert("invalid token");
                      }
                    
                    }

                    if(action == "gans"){
                      if(rGans.value.toLowerCase() == "gans" && tokenInput_gans.value.toLowerCase() == redm){
                        point_db = snapshot.val().point - (jGans.value * 15);
                        if(point_db >=0 ) {
                          point_text.innerHTML = "Points: " + point_db;
                          alert("Redeem succeed.\nPoint : "+point_db);
                        }
                        else{
                          alert("Sorry you dont have enough point.\nNeed more "+point_db);
                        }
                      }
                       
                      if(rPin.value.toLowerCase() == "gans" && tokenInput_gans.value.toLowerCase() != redm)
                        alert('invalid token');
                    }

                    if(action == "pin"){
                      if(rPin.value.toLowerCase() == "pin" && tokenInput_pin.value.toLowerCase() == redm){
                        point_db = snapshot.val().point - (jPin.value * 15);
                        if(point_db >=0 ) {
                          point_text.innerHTML = "Points: " + point_db;
                          alert("Redeem succeed.\nPoint : "+point_db);
                        }
                        else{
                          alert("Sorry you dont have enough point.\nNeed more "+point_db);
                        }
                      }
                       
                      if(rPin.value.toLowerCase() == "pin" && tokenInput_pin.value.toLowerCase() != redm)
                        alert('invalid token');
                    }

                    if(action == "stiker"){
                      if(rSticker.value.toLowerCase() == "stiker" && tokenInput_sticker.value.toLowerCase() == redm) {
                        point_db = snapshot.val().point - (jSticker.value * 10);
                        if(point_db >=0 ) {
                          point_text.innerHTML = "Points: " + point_db;
                          alert("Redeem succeed.\nPoint : "+point_db);
                        }
                        else{
                          alert("Sorry you dont have enough point.\nNeed more "+point_db);
                        }
                      }
                        
                      if(rSticker.value.toLowerCase() == "stiker" && tokenInput_sticker.value.toLowerCase() != redm)
                        alert('invalid token');
                    }

                    if(action == "kaos") {
                      if(rKaos.value.toLowerCase() == "kaos" && tokenInput_kaos.value.toLowerCase() == redm) {
                        point_db = snapshot.val().point - (jKaos.value * 150);
                        if(point_db >=0 ) {
                          point_text.innerHTML = "Points: " + point_db;
                          alert("Redeem succeed.\nPoint : "+point_db);
                        }
                        else{
                          alert("Sorry you dont have enough point.\nNeed more "+point_db);
                        }
                      }
                        
                      if(rKaos.value.toLowerCase() == "kaos" && tokenInput_kaos.value.toLowerCase() != redm)
                        alert('invalid token');
                    }
                        if(point_db >=0 ){
                        firebase.database().ref('users/' + uid+"/").update({
                    point: point_db,
                  }, function(error) {
                    if (error) {
                        console.log("failed");
                    } else {
                        console.log("success");
                        /* alert("Poin Collection succeed.\nPoint : "+point_db); */
                        tokenInput_collect.value = "";
                    }
                  });
                    }
                        else{
                        alert("Sorry you dont have enough point.\nNeed more "+point_db);    
                        }
                    });
                    
                    return false;
                
            }
            }
                else{
                window.location.href = 'login.html';
            }
                });

    </script>
    <script>
      
      /**********************\
         * login status check *
        \**********************/
        

        firebase.auth().onAuthStateChanged(function (user) {
            if (user) {

                 checkUser();
                console.log(user);
                document.getElementById('logout').onclick = function () {
                    if (confirm('Logout?')) {
                        firebase.auth().signOut(); // This will trigger onAuthStateChanged again, immediately.
                    }
                };
            } else {
                 //if not logged in yet
                  window.location.href = 'login.html';

            }
        });

        firebase.auth().onAuthStateChanged((user) => {
          if (user) {
            var uid = user.uid;
            var Absen = firebase.database().ref('Absen').child(uid);
        
            Absen.on('value', function (r) {

                $('#entries').html('Loading...');
                var html = '';
                r.forEach(function (item) {
                    entry = item.val()
                   // key = item.getKey()
                    html = '<div class="col-lg-4" padding: 1em;">' +
                            '<div class="card" style="margin-bottom : 2em; color:white;">' +
                              '<div  class="card-header" style="background: #84817a;">' + excerpt(entry.tanggal) + '</div>' +
                                '<div class="card-body" style="background: #75dab3;">' +
                                  '<p class="card-text">Absen jam : ' + entry.time + ' | ' + 'Status :' + entry.status + ' </p>' +
                                  '<p class="card-link">Lokasi : ' + excerpt(entry.lokasi) + '</p>' +
      
                                '</div>' +
                            '</div>' +
                          '</div> ' + html; // prepend the entry because we need to display it in reverse order
                });

                $('#entries').html(html);
            });

            /*************\
         * Utilities *
        \*************/

        function strip(html) {
            var tmp = document.createElement("DIV");
            tmp.innerHTML = html;
            return tmp.textContent || tmp.innerText || "";
        }

        function excerpt(text, length) {
            text = strip(text);
            text = $.trim(text); //trim whitespace
            if (text.length > length) {
                text = text.substring(0, length - 3) + '...';
            }
            return text;
        }

        function pad2Digit(num) {
            return ('0' + num.toString()).slice(-2);
        }

        function datetimeFormat(timestamp) {
            var dateObj = new Date(timestamp);
            var en_month = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
            return dateObj.getDate() + ' ' + en_month[dateObj.getMonth()] + ' ' + pad2Digit(dateObj.getFullYear()) + ' ' + pad2Digit(dateObj.getHours()) + ':' + pad2Digit(dateObj.getMinutes());
        }

            
          }
        });
     
    </script>
    <script type="text/javascript">
      function startTime(){
        var date = new Date();
        var hh = date.getHours(); // 0 - 23
        var mm = date.getMinutes(); // 0 - 59
        var ss = date.getSeconds(); // 0 - 59
        var session1 = "AM";
        
        if(hh == 0){
            hh = 12;
        }
        
        if(hh > 12){
            hh = hh - 12;
            session1 = "PM";
        }
        
        hh = (hh < 10) ? "0" + hh : hh;
        mm = (mm < 10) ? "0" + mm : mm;
        ss = (ss < 10) ? "0" + ss : ss;
        
        var time1 = hh + ":" + mm + ":" + ss + " " + session1;
        document.getElementById("MyClockDisplay").innerText = time1;
        document.getElementById("MyClockDisplay").textContent = time1;
        setTimeout(startTime, 1000);
    }

    startTime();
    </script>

</body>
</html>